<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./main.css" />
  </head>

  <body>
    <form enctype="multipart/form-data">
      <input id="upload" type="file" name="files[]" />
    </form>

    <form id="selected-page">
      <select id="sheet-paages"></select>
      <button type="submit">Enviar</button>
    </form>
    <pre>
    <div id="displayJsonContent">

    </div>
    </pre>
    <div class="player-card-wrapper">
      <!-- <div class="player-card">
        <div class="player-card-text">
          <h6><span>Timestamp:</span> 6/4/2024 23:39:21</h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span>Qual o seu nome? (Nick e nome de personagem):</span> nick -
            vodsunz || personagem - Kish
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª passa quanto tempo em media dentro da cÃºpula (quanto tempo
              passa on? horas e dias da semana):</span
            >
            Normalmente umas 3 horas por
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >Qual sua capacidade de se defender e defender aos outros? (vocÃª
              sabe pvp ou tem equipamentos bons?):</span
            >
            NÃ£o tenho equipamentos bons, mas se tivesse, saberia me defender
            razoavelmente.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª costuma se envolver em problemas? (se sim, de
              exemplos):</span
            >
            NÃ£o.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span>VocÃª sabe mexer com maquinas? (o quanto vc sabe?):</span> Sim,
            coisas muito simples e bÃ¡sicas, como uma furadeira, por exemplo.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª sabe construir? (independentemente de saber ou nÃ£o, vocÃª
              gosta de construir?):</span
            >
            Sim, gosto.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª tem uma moradia estÃ¡vel? (e vocÃª mora com mais
              pessoas?):</span
            >
            Sim. NÃ£o.
          </h6>
        </div>
        <div class="player-card-text">
          <h6><span>VocÃª gosta de cozinhar?:</span> Sim, Ã© um hobby.</h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span>VocÃª gosta de animais (Se sim, quais)?:</span> Sim, raposas.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª jÃ¡ teve experiÃªncia com crianÃ§as em sua simulaÃ§Ã£o? (se sim
              conte um pouco sobre):</span
            >
            Sim, jÃ¡ que fui uma. NÃ£o tive boas experiÃªncias jÃ¡ me sentia
            diferente e excluÃ­do do resto, sendo difÃ­cil de interagir e se
            enturmar com elas.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >Em uma escala de 1 a 10 quÃ£o paciente vocÃª Ã©? (sendo 1 sem
              paciÃªncia alguma e 10 sendo uma pessoa q passaria o tempo q fosse
              pra ajudar ou explicar algo a alguÃ©m):</span
            >
            5
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span>Alguma duvida ou algo a acrescentar?:</span> Respondi isso
            como meu personagem responderia viu
            <br />
            Obrigado pela pesquisa e pelo tempo de vocÃªs nesse projeto, tÃ¡ sendo
            bem divertido participar, beijos ğŸ«¶ğŸ«¶
          </h6>
        </div>
      </div>
      <div class="player-card">
        <div class="player-card-text">
          <h6><span>Timestamp:</span> 6/4/2024 23:39:21</h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span>Qual o seu nome? (Nick e nome de personagem):</span> nick -
            vodsunz || personagem - Kish
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª passa quanto tempo em media dentro da cÃºpula (quanto tempo
              passa on? horas e dias da semana):</span
            >
            Normalmente umas 3 horas por
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >Qual sua capacidade de se defender e defender aos outros? (vocÃª
              sabe pvp ou tem equipamentos bons?):</span
            >
            NÃ£o tenho equipamentos bons, mas se tivesse, saberia me defender
            razoavelmente.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª costuma se envolver em problemas? (se sim, de
              exemplos):</span
            >
            NÃ£o.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span>VocÃª sabe mexer com maquinas? (o quanto vc sabe?):</span> Sim,
            coisas muito simples e bÃ¡sicas, como uma furadeira, por exemplo.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª sabe construir? (independentemente de saber ou nÃ£o, vocÃª
              gosta de construir?):</span
            >
            Sim, gosto.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª tem uma moradia estÃ¡vel? (e vocÃª mora com mais
              pessoas?):</span
            >
            Sim. NÃ£o.
          </h6>
        </div>
        <div class="player-card-text">
          <h6><span>VocÃª gosta de cozinhar?:</span> Sim, Ã© um hobby.</h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span>VocÃª gosta de animais (Se sim, quais)?:</span> Sim, raposas.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >VocÃª jÃ¡ teve experiÃªncia com crianÃ§as em sua simulaÃ§Ã£o? (se sim
              conte um pouco sobre):</span
            >
            Sim, jÃ¡ que fui uma. NÃ£o tive boas experiÃªncias jÃ¡ me sentia
            diferente e excluÃ­do do resto, sendo difÃ­cil de interagir e se
            enturmar com elas.
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span
              >Em uma escala de 1 a 10 quÃ£o paciente vocÃª Ã©? (sendo 1 sem
              paciÃªncia alguma e 10 sendo uma pessoa q passaria o tempo q fosse
              pra ajudar ou explicar algo a alguÃ©m):</span
            >
            5
          </h6>
        </div>
        <div class="player-card-text">
          <h6>
            <span>Alguma duvida ou algo a acrescentar?:</span> Respondi isso
            como meu personagem responderia viu
            <br />
            Obrigado pela pesquisa e pelo tempo de vocÃªs nesse projeto, tÃ¡ sendo
            bem divertido participar, beijos ğŸ«¶ğŸ«¶
          </h6>
        </div>
      </div> -->
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
    <script>
      let jsonSheet = [];

      var ExcelToJSON = function () {
        this.parseExcel = function (file) {
          var reader = new FileReader();

          reader.onload = function (e) {
            var data = e.target.result;
            var workbook = XLSX.read(data, {
              type: "binary",
            });
            var i = -1;
            workbook.SheetNames.forEach(function (sheetName) {
              i++;

              $("#sheet-paages").append(
                '<option value="' + i + '">' + sheetName + "</option>"
              );

              var XL_row_object = XLSX.utils.sheet_to_row_object_array(
                workbook.Sheets[sheetName]
              );
              var json_object = JSON.stringify(XL_row_object);

              jsonSheet.push(JSON.parse(json_object));
            });
          };

          reader.onerror = function (ex) {
            console.log(ex);
          };

          reader.readAsBinaryString(file);
        };
      };

      function handleFileSelect(evt) {
        var files = evt.target.files;
        var xl2json = new ExcelToJSON();
        xl2json.parseExcel(files[0]);
      }

      $(document).ready(function () {
        $("#selected-page").submit(function (e) {
          e.preventDefault();
          const selectedPage = $("#sheet-paages").val();

          const selectedPageonSheet = jsonSheet[selectedPage];

          // $("#displayJsonContent").html(
          //   JSON.stringify(selectedPageonSheet, undefined, 4)
          // );

          const playerCardWrapper = document.querySelector(
            ".player-card-wrapper"
          );

          selectedPageonSheet.forEach((player) => {
            const playerCard = document.createElement("div");
            playerCard.classList.add("player-card");

            const playerCardText = document.createElement("div");
            playerCardText.classList.add("player-card-text");

            const playerCardTextContent = document.createElement("h6");

            Object.entries(player).forEach(([key, value]) => {
              const span = document.createElement("span");
              span.textContent = key + ": ";
              const textNode = document.createTextNode(value);
              playerCardTextContent.appendChild(span);
              playerCardTextContent.appendChild(textNode);
            });

            playerCardText.appendChild(playerCardTextContent);
            playerCard.appendChild(playerCardText);
            playerCardWrapper.appendChild(playerCard);
          });

          console.log(selectedPageonSheet);
        });
      });

      //     {
      //     "Timestamp": "6/4/2024 23:39:21",
      //     "Qual o seu nome? (Nick e nome de personagem)": "nick - vodsunz || personagem - Kish",
      //     "VocÃª passa quanto tempo em media dentro da cÃºpula (quanto tempo passa on? horas e dias da semana)": "Normalmente umas 3 horas por dia, as vezes de manhÃ£ e as vezes de noite, em finais de semana ou feriados e as vezes (mas bem raramente) em dias de semana.",
      //     "Qual sua capacidade de se defender e defender aos outros? (vocÃª sabe pvp ou tem equipamentos bons?)": "NÃ£o tenho equipamentos bons, mas se tivesse, saberia me defender razoavelmente.",
      //     "VocÃª costuma se envolver em problemas? (se sim, de exemplos)": "NÃ£o.",
      //     "VocÃª sabe mexer com maquinas? (o quanto vc sabe?)": "Sim, coisas muito simples e bÃ¡sicas, como uma furadeira, por exemplo.",
      //     "VocÃª sabe construir? (independentemente de saber ou nÃ£o, vocÃª gosta de construir?)": "Sim, gosto.",
      //     "VocÃª tem uma moradia estÃ¡vel? (e vocÃª mora com mais pessoas?)": "Sim. NÃ£o.",
      //     "VocÃª gosta de cozinhar?": "Sim, Ã© um hobby.",
      //     "VocÃª gosta de animais (Se sim, quais)?": "Sim, raposas.",
      //     "VocÃª jÃ¡ teve experiÃªncia com crianÃ§as em sua simulaÃ§Ã£o? (se sim conte um pouco sobre)": "Sim, jÃ¡ que fui uma. NÃ£o tive boas experiÃªncias jÃ¡ me sentia diferente e excluÃ­do do resto, sendo difÃ­cil de interagir e se enturmar com elas.",
      //     "Em uma escala de 1 a 10 quÃ£o paciente vocÃª Ã©? (sendo 1 sem paciÃªncia alguma e 10 sendo uma pessoa q passaria o tempo q fosse pra ajudar ou explicar algo a alguÃ©m)": "5",
      //     "Alguma duvida ou algo a acrescentar?": "Respondi isso como meu personagem responderia viu\nObrigado pela pesquisa e pelo tempo de vocÃªs nesse projeto, tÃ¡ sendo bem divertido participar, beijos ğŸ«¶ğŸ«¶"
      // },
    </script>
    <script>
      document
        .getElementById("upload")
        .addEventListener("change", handleFileSelect, false);
    </script>
  </body>
</html>
